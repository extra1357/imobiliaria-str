# üîí Relat√≥rio de Auditoria de Seguran√ßa

**Data:** 06/01/2026 20:28:00

## üìä Estat√≠sticas

| M√©trica | Valor |
|---------|-------|
| Arquivos Escaneados | 97 |
| Linhas de C√≥digo | 8,623 |
| **Score de Seguran√ßa** | **0/100** |
| Total de Vulnerabilidades | 109 |

## üö® Vulnerabilidades por Severidade

| Severidade | Quantidade |
|------------|------------|
| üî¥ CR√çTICA | 10 |
| üü† ALTA | 69 |
| üü° M√âDIA | 30 |
| üü¢ BAIXA | 0 |


## üî¥ Vulnerabilidades CRITICAL

### 1. open_middleware

**Arquivo:** `src/middleware.ts`  
**Linha:** 4  
**CWE:** CWE-306

**Descri√ß√£o:** Middleware completamente aberto (sem prote√ß√£o)

**Recomenda√ß√£o:** Implemente verifica√ß√£o de autentica√ß√£o no middleware

**C√≥digo:**
```

export function middleware(request: NextRequest) {
  // Libera√ß√£o Total: ignora qualquer checagem de cookie ou sess√£o
  return NextResponse.next();
```

---

### 2. fake_token

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 56  
**CWE:** CWE-287

**Descri√ß√£o:** Token de autentica√ß√£o falso usando apenas ID do usu√°rio

**Recomenda√ß√£o:** Implemente JWT real com jsonwebtoken ou jose

**C√≥digo:**
```
      data: {
        token: `bearer-${user.id}`,
        user: userData
      }
```

---

### 3. bypass_login

**Arquivo:** `src/app/admin/login/page.tsx`  
**Linha:** 13  
**CWE:** CWE-798

**Descri√ß√£o:** Bypass de autentica√ß√£o via cookie setado no cliente

**Recomenda√ß√£o:** Remova esse c√≥digo e implemente autentica√ß√£o server-side

**C√≥digo:**
```
    // Simula a grava√ß√£o do cookie no navegador para o sistema achar que voc√™ logou
    document.cookie = "admin-logged=true; path=/";
    
    setTimeout(() => {
```

---

### 4. hardcoded_secret

**Arquivo:** `next.config.js`  
**Linha:** 26  
**CWE:** CWE-798

**Descri√ß√£o:** Secret/senha hardcoded no c√≥digo

**Recomenda√ß√£o:** Mova para vari√°veis de ambiente

**C√≥digo:**
```
        headers: [
          { key: 'Cache-Control', value: 'no-store, must-revalidate' }
        ]
      },
```

---

### 5. hardcoded_secret

**Arquivo:** `next.config.js`  
**Linha:** 32  
**CWE:** CWE-798

**Descri√ß√£o:** Secret/senha hardcoded no c√≥digo

**Recomenda√ß√£o:** Mova para vari√°veis de ambiente

**C√≥digo:**
```
        headers: [
          { key: 'Cache-Control', value: 'public, max-age=31536000, immutable' }
        ]
      }
```

---

### 6. unencrypted_pii

**Arquivo:** `prisma/schema.prisma`  
**Linha:** 88  
**CWE:** CWE-311

**Descri√ß√£o:** Campo 'cpf' sem criptografia (viola√ß√£o LGPD)

**Recomenda√ß√£o:** Implemente criptografia AES-256 ou use @db.Text com hash

**C√≥digo:**
```
cpf       String?  @unique
```

---

### 7. unencrypted_pii

**Arquivo:** `prisma/schema.prisma`  
**Linha:** 182  
**CWE:** CWE-311

**Descri√ß√£o:** Campo 'senha' sem criptografia (viola√ß√£o LGPD)

**Recomenda√ß√£o:** Implemente criptografia AES-256 ou use @db.Text com hash

**C√≥digo:**
```
senha     String
```

---

### 8. hardcoded_secret

**Arquivo:** `next.config.js`  
**Linha:** 26  
**CWE:** CWE-798

**Descri√ß√£o:** Secret/senha hardcoded no c√≥digo

**Recomenda√ß√£o:** Mova para vari√°veis de ambiente

**C√≥digo:**
```
        headers: [
          { key: 'Cache-Control', value: 'no-store, must-revalidate' }
        ]
      },
```

---

### 9. hardcoded_secret

**Arquivo:** `next.config.js`  
**Linha:** 32  
**CWE:** CWE-798

**Descri√ß√£o:** Secret/senha hardcoded no c√≥digo

**Recomenda√ß√£o:** Mova para vari√°veis de ambiente

**C√≥digo:**
```
        headers: [
          { key: 'Cache-Control', value: 'public, max-age=31536000, immutable' }
        ]
      }
```

---

### 10. env_committed

**Arquivo:** `.env`  
**Linha:** 1  
**CWE:** CWE-540

**Descri√ß√£o:** Arquivo .env n√£o deve ser commitado (cont√©m secrets)

**Recomenda√ß√£o:** Adicione .env ao .gitignore e rotacione todos os secrets

**C√≥digo:**
```
Arquivo .env encontrado no projeto
```

---


## üü† Vulnerabilidades HIGH

### 1. prisma_per_request

**Arquivo:** `prisma/seed.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient()

async function main() {
```

---

### 2. no_rate_limit

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 8  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```

export async function POST(req: NextRequest) {
  try {
    const { query } = await req.json()
```

---

### 3. no_input_validation

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 10  
**CWE:** CWE-20

**Descri√ß√£o:** Dados de entrada sem valida√ß√£o

**Recomenda√ß√£o:** Use Zod, Yup ou Joi para validar inputs

**C√≥digo:**
```
  try {
    const { query } = await req.json()
    const resultados = await buscaService.buscaInteligente(query)
    return successResponse(resultados)
```

---

### 4. no_csrf

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 8  
**CWE:** CWE-352

**Descri√ß√£o:** POST sem prote√ß√£o CSRF

**Recomenda√ß√£o:** Implemente tokens CSRF

**C√≥digo:**
```

export async function POST(req: NextRequest) {
  try {
    const { query } = await req.json()
```

---

### 5. no_rate_limit

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 29  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```
 */
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 6. no_csrf

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 29  
**CWE:** CWE-352

**Descri√ß√£o:** POST sem prote√ß√£o CSRF

**Recomenda√ß√£o:** Implemente tokens CSRF

**C√≥digo:**
```
 */
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 7. prisma_per_request

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient();

export async function POST(request: Request) {
```

---

### 8. no_rate_limit

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 6  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 9. no_csrf

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 6  
**CWE:** CWE-352

**Descri√ß√£o:** POST sem prote√ß√£o CSRF

**Recomenda√ß√£o:** Implemente tokens CSRF

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 10. prisma_per_request

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient();

export async function POST(request: Request) {
```

---

### 11. no_rate_limit

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 6  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const text = await request.text();
```

---

### 12. no_csrf

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 6  
**CWE:** CWE-352

**Descri√ß√£o:** POST sem prote√ß√£o CSRF

**Recomenda√ß√£o:** Implemente tokens CSRF

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const text = await request.text();
```

---

### 13. no_rate_limit

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 21  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json()
```

---

### 14. no_input_validation

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 23  
**CWE:** CWE-20

**Descri√ß√£o:** Dados de entrada sem valida√ß√£o

**Recomenda√ß√£o:** Use Zod, Yup ou Joi para validar inputs

**C√≥digo:**
```
  try {
    const body = await req.json()
    const analise = await prisma.analiseMercado.create({ data: body })
    return successResponse(analise, 'An√°lise criada', 201)
```

---

### 15. no_csrf

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 21  
**CWE:** CWE-352

**Descri√ß√£o:** POST sem prote√ß√£o CSRF

**Recomenda√ß√£o:** Implemente tokens CSRF

**C√≥digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json()
```

---

### 16. no_rate_limit

**Arquivo:** `src/app/api/imoveis/route.ts`  
**Linha:** 23  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```
// POST: Cria um novo im√≥vel
export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 17. prisma_per_request

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 9  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```
// Inst√¢ncia local do Prisma para garantir que o build n√£o quebre por imports externos
const prisma = new PrismaClient();

export async function POST(req: NextRequest) {
```

---

### 18. no_rate_limit

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 11  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json();
```

---

### 19. no_input_validation

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 13  
**CWE:** CWE-20

**Descri√ß√£o:** Dados de entrada sem valida√ß√£o

**Recomenda√ß√£o:** Use Zod, Yup ou Joi para validar inputs

**C√≥digo:**
```
  try {
    const body = await req.json();
    const { email, password } = body;

```

---

### 20. no_csrf

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 11  
**CWE:** CWE-352

**Descri√ß√£o:** POST sem prote√ß√£o CSRF

**Recomenda√ß√£o:** Implemente tokens CSRF

**C√≥digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json();
```

---

### 21. no_rate_limit

**Arquivo:** `src/app/api/leads/[id]/historico/route.ts`  
**Linha:** 5  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```
// POST: Adiciona um novo ponto na timeline do lead
export async function POST(request: Request, { params }: { params: { id: string } }) {
  try {
    const { detalhes, tipo } = await request.json();
```

---

### 22. no_csrf

**Arquivo:** `src/app/api/leads/[id]/historico/route.ts`  
**Linha:** 5  
**CWE:** CWE-352

**Descri√ß√£o:** POST sem prote√ß√£o CSRF

**Recomenda√ß√£o:** Implemente tokens CSRF

**C√≥digo:**
```
// POST: Adiciona um novo ponto na timeline do lead
export async function POST(request: Request, { params }: { params: { id: string } }) {
  try {
    const { detalhes, tipo } = await request.json();
```

---

### 23. prisma_per_request

**Arquivo:** `src/app/api/consultas/funil/route.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient();

// Esta rota agora apenas serve os dados para o seu c√≥digo gigante acima
```

---

### 24. no_rate_limit

**Arquivo:** `src/app/api/consultas/[id]/route.ts`  
**Linha:** 6  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```
// Atualizar status da consulta
export async function PATCH(
  req: NextRequest,
  { params }: { params: { id: string } }
```

---

### 25. no_input_validation

**Arquivo:** `src/app/api/consultas/[id]/route.ts`  
**Linha:** 11  
**CWE:** CWE-20

**Descri√ß√£o:** Dados de entrada sem valida√ß√£o

**Recomenda√ß√£o:** Use Zod, Yup ou Joi para validar inputs

**C√≥digo:**
```
  try {
    const body = await req.json()
    const { id } = params

```

---

### 26. no_rate_limit

**Arquivo:** `src/app/api/imoveis/cadastro/route.ts`  
**Linha:** 4  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 27. no_csrf

**Arquivo:** `src/app/api/imoveis/cadastro/route.ts`  
**Linha:** 4  
**CWE:** CWE-352

**Descri√ß√£o:** POST sem prote√ß√£o CSRF

**Recomenda√ß√£o:** Implemente tokens CSRF

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 28. prisma_per_request

**Arquivo:** `src/app/api/imoveis/[id]/route.ts`  
**Linha:** 6  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient();

export async function PATCH(
```

---

### 29. no_rate_limit

**Arquivo:** `src/app/api/imoveis/[id]/route.ts`  
**Linha:** 8  
**CWE:** CWE-770

**Descri√ß√£o:** Endpoint sem rate limiting

**Recomenda√ß√£o:** Implemente rate limiting com Upstash Redis ou similar

**C√≥digo:**
```

export async function PATCH(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 30. no_auth_check

**Arquivo:** `GUIA/GerenciadorImoveis.tsx`  
**Linha:** 148  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function GerenciadorImoveis() {
  const [imoveis, setImoveis] = useState<Imovel[]>(initialImoveis);
  const [proprietarios] = useState<Proprietario[]>(initialProprietarios); 
```

---

### 31. no_auth_check

**Arquivo:** `reserva/page.tsx`  
**Linha:** 4  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function Home() {
  return (
    <html lang="pt-BR">
```

---

### 32. dangerouslySetInnerHTML

**Arquivo:** `reserva/page.tsx`  
**Linha:** 13  
**CWE:** CWE-79

**Descri√ß√£o:** Uso de dangerouslySetInnerHTML (risco XSS)

**Recomenda√ß√£o:** Sanitize HTML com DOMPurify antes de usar

**C√≥digo:**
```
      <body style={{ margin: 0, padding: 0 }}>
        <style dangerouslySetInnerHTML={{ __html: `
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; }
```

---

### 33. dangerouslySetInnerHTML

**Arquivo:** `reserva/page.tsx`  
**Linha:** 130  
**CWE:** CWE-79

**Descri√ß√£o:** Uso de dangerouslySetInnerHTML (risco XSS)

**Recomenda√ß√£o:** Sanitize HTML com DOMPurify antes de usar

**C√≥digo:**
```

        <script dangerouslySetInnerHTML={{ __html: `
          document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.altKey && e.key === 'r') {
```

---

### 34. no_auth_check

**Arquivo:** `src/app/page.tsx`  
**Linha:** 32  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function Home() {
  const router = useRouter();
  const [properties, setProperties] = useState<Imovel[]>([]);
```

---

### 35. dangerouslySetInnerHTML

**Arquivo:** `src/app/page.tsx`  
**Linha:** 140  
**CWE:** CWE-79

**Descri√ß√£o:** Uso de dangerouslySetInnerHTML (risco XSS)

**Recomenda√ß√£o:** Sanitize HTML com DOMPurify antes de usar

**C√≥digo:**
```
    <>
      <style dangerouslySetInnerHTML={{ __html: `
        :root { --bg:#f0f4f8; --card:#ffffff; --accent:#1e40af; --accent-light:#3b82f6; --text:#0f172a; --muted:#64748b; --max-width:1200px; }
        * { box-sizing: border-box; }
```

---

### 36. no_auth_check

**Arquivo:** `src/app/layout.tsx`  
**Linha:** 9  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function RootLayout({
  children,
}: {
```

---

### 37. no_auth_check

**Arquivo:** `src/components/Navbar.tsx`  
**Linha:** 5  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function Navbar() {
  const pathname = usePathname()
  
```

---

### 38. no_auth_check

**Arquivo:** `src/app/proprietarios/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function ProprietariosPage() {
  const [props, setProps] = useState<any[]>([])
  const [loading, setLoading] = useState<boolean>(true)
```

---

### 39. no_auth_check

**Arquivo:** `src/app/admin/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function AdminDashboard() {
  const [stats, setStats] = useState({ imoveis: 0, leads: 0 });
  const [loading, setLoading] = useState(true);
```

---

### 40. no_auth_check

**Arquivo:** `src/app/gerenciador-imoveis/page.tsx`  
**Linha:** 107  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```
// --------------------------------------------------------------------------------
export default function GerenciadorStatusImoveis() {
  const [imoveis, setImoveis] = useState<Imovel[]>([]);
  const [proprietarios, setProprietarios] = useState<Proprietario[]>([]);
```

---

### 41. no_auth_check

**Arquivo:** `src/app/toolbox/page.tsx`  
**Linha:** 19  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function Toolbox() {
  const sections = [
    {
```

---

### 42. no_auth_check

**Arquivo:** `src/app/imoveis-publicos/page.tsx`  
**Linha:** 5  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function ImoveisPublicos() {
  const [imoveis, setImoveis] = useState<any[]>([])
  const [filtro, setFiltro] = useState<any>({ tipo: 'todos', maxPreco: 9999999 })
```

---

### 43. no_auth_check

**Arquivo:** `src/app/proprietarios/novo/page.tsx`  
**Linha:** 14  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function NovoProprietario() {
  // Estados de controle da UI
  const [loading, setLoading] = useState<boolean>(false)
```

---

### 44. no_auth_check

**Arquivo:** `src/app/admin/dashboard/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function AdminDashboard() {
  const router = useRouter();
  
```

---

### 45. no_auth_check

**Arquivo:** `src/app/admin/leads/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function LeadsPage() {
  const [leads, setLeads] = useState<any[]>([]);
  const [loading, setLoading] = useState<boolean>(true);
```

---

### 46. no_auth_check

**Arquivo:** `src/app/admin/performance/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function PerformancePage() {
  const [data, setData] = useState<any>(null);

```

---

### 47. no_auth_check

**Arquivo:** `src/app/admin/login/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function LoginPage() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 48. no_auth_check

**Arquivo:** `src/app/admin/consultas/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function ListaConsultas() {
  const [consultas, setConsultas] = useState([])
  const [loading, setLoading] = useState(true)
```

---

### 49. no_auth_check

**Arquivo:** `src/app/admin/analise-mercado/page.tsx`  
**Linha:** 19  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function AnaliseMercado() {
  const [analises, setAnalises] = useState<Analise[]>([])
  const [loading, setLoading] = useState<boolean>(true)
```

---

### 50. no_auth_check

**Arquivo:** `src/app/admin/imoveis/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function ImoveisPage() {
  const [imoveis, setImoveis] = useState<any[]>([]);
  const [loading, setLoading] = useState<boolean>(true);
```

---

### 51. no_auth_check

**Arquivo:** `src/app/admin/leads/novo/page.tsx`  
**Linha:** 8  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function NovoLead() {
  const router = useRouter()
  const [form, setForm] = useState({ 
```

---

### 52. no_auth_check

**Arquivo:** `src/app/admin/leads/relatorio/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function RelatorioLeads() {
  // ‚úÖ ACESSO TOTAL: Dados locais para garantir que os c√°lculos de % n√£o deem erro de divis√£o por zero
  const [leads, setLeads] = useState<any[]>([
```

---

### 53. no_auth_check

**Arquivo:** `src/app/admin/consultas/nova/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function NovaConsulta() {
  const router = useRouter()
  const [isSubmitting, setIsSubmitting] = useState(false)
```

---

### 54. no_auth_check

**Arquivo:** `src/app/admin/consultas/historico/page.tsx`  
**Linha:** 5  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function HistoricoConsultas() {
  const [consultas, setConsultas] = useState<any[]>([])
  const [filtro, setFiltro] = useState<string>('todas')
```

---

### 55. no_auth_check

**Arquivo:** `src/app/admin/consultas/funil/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function FunilVendas() {
  const [consultas, setConsultas] = useState<any[]>([])
  const [loading, setLoading] = useState<boolean>(true)
```

---

### 56. no_auth_check

**Arquivo:** `src/app/admin/analise-mercado/nova/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function NovaAnalise() {
  const router = useRouter()
  const [loading, setLoading] = useState<boolean>(false)
```

---

### 57. no_auth_check

**Arquivo:** `src/app/admin/analise-mercado/relatorios/page.tsx`  
**Linha:** 18  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function RelatoriosAnalise() {
  const [analises, setAnalises] = useState<AnaliseMercado[]>([])
  const [cidades, setCidades] = useState<string[]>([])
```

---

### 58. no_auth_check

**Arquivo:** `src/app/admin/imoveis/novo/page.tsx`  
**Linha:** 23  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function NovoImovel() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 59. no_auth_check

**Arquivo:** `src/app/admin/imoveis/disponiveis/page.tsx`  
**Linha:** 13  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function ImoveisDisponiveis() {
  const [imoveis, setImoveis] = useState<Imovel[]>([])
  const [loading, setLoading] = useState<boolean>(true)
```

---

### 60. no_auth_check

**Arquivo:** `src/app/api/leads/[id]/page.tsx`  
**Linha:** 8  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function DetalhesLead() {
  const { id } = useParams();
  const router = useRouter();
```

---

### 61. no_auth_check

**Arquivo:** `src/components/graficos/GraficoMercados.tsx`  
**Linha:** 4  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function GraficoMercado({ dados }: { dados: any[] }) {
  return (
    <div className="bg-white p-6 rounded-lg">
```

---

### 62. no_auth_check

**Arquivo:** `src/components/busca/BuscaInteligente.tsx`  
**Linha:** 4  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function BuscaInteligente() {
  const [query, setQuery] = useState<string>('')
  const [resultados, setResultados] = useState<any[]>([])
```

---

### 63. no_auth_check

**Arquivo:** `src/components/ui/Badge.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function Badge({ children, variant = 'neutral', className = '' }: BadgeProps) {
  const variants = {
    success: 'badge-success',
```

---

### 64. no_auth_check

**Arquivo:** `src/components/ui/Container.tsx`  
**Linha:** 10  
**CWE:** CWE-306

**Descri√ß√£o:** Componente/p√°gina sem verifica√ß√£o de autentica√ß√£o

**Recomenda√ß√£o:** Adicione verifica√ß√£o de sess√£o ou proteja com middleware

**C√≥digo:**
```

export default function Container({ children, title, subtitle, action }: ContainerProps) {
  return (
    <div className="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
```

---

### 65. prisma_per_request

**Arquivo:** `create-admin.js`  
**Linha:** 4  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient();

async function createAdmin() {
```

---

### 66. prisma_per_request

**Arquivo:** `test-db.js`  
**Linha:** 3  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient();

async function testarBanco() {
```

---

### 67. prisma_per_request

**Arquivo:** `test-db-completo.js`  
**Linha:** 3  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient();

async function testarBancoCompleto() {
```

---

### 68. prisma_per_request

**Arquivo:** `api-test-db.js`  
**Linha:** 3  
**CWE:** CWE-404

**Descri√ß√£o:** Nova inst√¢ncia do Prisma por requisi√ß√£o (esgota conex√µes)

**Recomenda√ß√£o:** Use singleton pattern para PrismaClient

**C√≥digo:**
```

const prisma = new PrismaClient();

export default async function handler(req, res) {
```

---

### 69. exposed_env_var

**Arquivo:** `.env`  
**Linha:** 22  
**CWE:** CWE-798

**Descri√ß√£o:** Poss√≠vel credencial real em arquivo .env

**Recomenda√ß√£o:** Verifique se este arquivo n√£o foi commitado e rotacione credenciais

**C√≥digo:**
```
NEXTAUTH_SECRET="SUA_CHAVE_STR_SECRET_AQUI"...
```

---


## üü° Vulnerabilidades MEDIUM

### 1. no_cors

**Arquivo:** `src/app/admin/analise-mercado/route/route.ts`  
**Linha:** 13  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET() {
  try {
    // Query corrigida com o nome correto da tabela: analises_mercado
```

---

### 2. no_cors

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function POST(req: NextRequest) {
  try {
    const { query } = await req.json()
```

---

### 3. dynamic_force_open

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 2  
**CWE:** CWE-400

**Descri√ß√£o:** Rota for√ßada como din√¢mica (pode impactar performance)

**Recomenda√ß√£o:** Revise se realmente precisa ser din√¢mica

**C√≥digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
import { NextRequest } from 'next/server'
```

---

### 4. no_cors

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 29  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```
 */
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 5. no_cors

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 148  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```
 */
export async function GET(request: NextRequest) {
  try {
    const proprietarios = await prisma.proprietario.findMany({
```

---

### 6. dynamic_force_open

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 5  
**CWE:** CWE-400

**Descri√ß√£o:** Rota for√ßada como din√¢mica (pode impactar performance)

**Recomenda√ß√£o:** Revise se realmente precisa ser din√¢mica

**C√≥digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 7. no_cors

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 6  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 8. no_cors

**Arquivo:** `src/app/api/analises/route.ts`  
**Linha:** 7  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET(req: NextRequest) {
  try {
    const cidade = req.nextUrl.searchParams.get('cidade') || 'S√£o Paulo'
```

---

### 9. dynamic_force_open

**Arquivo:** `src/app/api/analises/route.ts`  
**Linha:** 2  
**CWE:** CWE-400

**Descri√ß√£o:** Rota for√ßada como din√¢mica (pode impactar performance)

**Recomenda√ß√£o:** Revise se realmente precisa ser din√¢mica

**C√≥digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
import { NextRequest } from 'next/server'
```

---

### 10. no_cors

**Arquivo:** `src/app/api/teste-conexao/route.ts`  
**Linha:** 4  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET() {
  try {
    // 1. Tenta fazer uma consulta ultra simples (contar registros)
```

---

### 11. no_cors

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 6  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const text = await request.text();
```

---

### 12. no_cors

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 44  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET() {
  try {
    const consultas = await prisma.consulta.findMany({
```

---

### 13. no_cors

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET(req: NextRequest) {
  try {
    const cidade = req.nextUrl.searchParams.get('cidade')
```

---

### 14. dynamic_force_open

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 2  
**CWE:** CWE-400

**Descri√ß√£o:** Rota for√ßada como din√¢mica (pode impactar performance)

**Recomenda√ß√£o:** Revise se realmente precisa ser din√¢mica

**C√≥digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
import { NextRequest } from 'next/server'
```

---

### 15. no_cors

**Arquivo:** `src/app/api/imoveis/route.ts`  
**Linha:** 5  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```
// GET: Lista todos os im√≥veis com dados do propriet√°rio
export async function GET() {
  try {
    const imoveis = await prisma.imovel.findMany({
```

---

### 16. no_cors

**Arquivo:** `src/app/api/imoveis/route.ts`  
**Linha:** 23  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```
// POST: Cria um novo im√≥vel
export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 17. no_cors

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 11  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json();
```

---

### 18. dynamic_force_open

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri√ß√£o:** Rota for√ßada como din√¢mica (pode impactar performance)

**Recomenda√ß√£o:** Revise se realmente precisa ser din√¢mica

**C√≥digo:**
```
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 19. no_cors

**Arquivo:** `src/app/api/relatorios/route.ts`  
**Linha:** 4  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET() {
  try {
    // 1. Busca volum√©trica total
```

---

### 20. no_cors

**Arquivo:** `src/app/api/leads/[id]/route.ts`  
**Linha:** 4  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET(
  request: Request,
  { params }: { params: { id: string } }
```

---

### 21. no_cors

**Arquivo:** `src/app/api/leads/[id]/historico/route.ts`  
**Linha:** 5  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```
// POST: Adiciona um novo ponto na timeline do lead
export async function POST(request: Request, { params }: { params: { id: string } }) {
  try {
    const { detalhes, tipo } = await request.json();
```

---

### 22. no_cors

**Arquivo:** `src/app/api/consultas/funil/route.ts`  
**Linha:** 7  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```
// Esta rota agora apenas serve os dados para o seu c√≥digo gigante acima
export async function GET() {
  try {
    const consultas = await prisma.consulta.findMany({
```

---

### 23. no_cors

**Arquivo:** `src/app/api/consultas/[id]/route.ts`  
**Linha:** 6  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```
// Atualizar status da consulta
export async function PATCH(
  req: NextRequest,
  { params }: { params: { id: string } }
```

---

### 24. no_cors

**Arquivo:** `src/app/api/consultas/[id]/route.ts`  
**Linha:** 37  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```
// Buscar detalhes da consulta
export async function GET(
  req: NextRequest,
  { params }: { params: { id: string } }
```

---

### 25. no_cors

**Arquivo:** `src/app/api/imoveis/cadastro/route.ts`  
**Linha:** 4  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 26. no_cors

**Arquivo:** `src/app/api/imoveis/publico/route.ts`  
**Linha:** 10  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url)
```

---

### 27. dynamic_force_open

**Arquivo:** `src/app/api/imoveis/publico/route.ts`  
**Linha:** 4  
**CWE:** CWE-400

**Descri√ß√£o:** Rota for√ßada como din√¢mica (pode impactar performance)

**Recomenda√ß√£o:** Revise se realmente precisa ser din√¢mica

**C√≥digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 28. no_cors

**Arquivo:** `src/app/api/imoveis/[id]/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function PATCH(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 29. no_cors

**Arquivo:** `src/app/api/imoveis/[id]/route.ts`  
**Linha:** 90  
**CWE:** CWE-942

**Descri√ß√£o:** API sem configura√ß√£o CORS

**Recomenda√ß√£o:** Configure CORS adequadamente

**C√≥digo:**
```

export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 30. dynamic_force_open

**Arquivo:** `src/app/toolbox/page.tsx`  
**Linha:** 3  
**CWE:** CWE-400

**Descri√ß√£o:** Rota for√ßada como din√¢mica (pode impactar performance)

**Recomenda√ß√£o:** Revise se realmente precisa ser din√¢mica

**C√≥digo:**
```

export const dynamic = 'force-dynamic';

import React from 'react';
```

---

