# 游 Relat칩rio de Auditoria de Seguran칞a

**Data:** 19/01/2026 21:58:26

## 游늵 Estat칤sticas

| M칠trica | Valor |
|---------|-------|
| Arquivos Escaneados | 139 |
| Linhas de C칩digo | 18,627 |
| **Score de Seguran칞a** | **0/100** |
| Total de Vulnerabilidades | 201 |

## 游뚿 Vulnerabilidades por Severidade

| Severidade | Quantidade |
|------------|------------|
| 游댮 CR칈TICA | 11 |
| 游 ALTA | 124 |
| 游리 M칄DIA | 66 |
| 游릭 BAIXA | 0 |


## 游댮 Vulnerabilidades CRITICAL

### 1. open_middleware

**Arquivo:** `backup_20260106_220909/middleware.ts`  
**Linha:** 4  
**CWE:** CWE-306

**Descri칞칚o:** Middleware completamente aberto (sem prote칞칚o)

**Recomenda칞칚o:** Implemente verifica칞칚o de autentica칞칚o no middleware

**C칩digo:**
```

export function middleware(request: NextRequest) {
  // Libera칞칚o Total: ignora qualquer checagem de cookie ou sess칚o
  return NextResponse.next();
```

---

### 2. fake_token

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 56  
**CWE:** CWE-287

**Descri칞칚o:** Token de autentica칞칚o falso usando apenas ID do usu치rio

**Recomenda칞칚o:** Implemente JWT real com jsonwebtoken ou jose

**C칩digo:**
```
      data: {
        token: `bearer-${user.id}`,
        user: userData
      }
```

---

### 3. hardcoded_secret

**Arquivo:** `src/app/api/auth/redefinir-senha/route.ts`  
**Linha:** 134  
**CWE:** CWE-798

**Descri칞칚o:** Secret/senha hardcoded no c칩digo

**Recomenda칞칚o:** Mova para vari치veis de ambiente

**C칩digo:**
```
  } catch (error: any) {
    console.error('Erro ao validar token:', error);
    return NextResponse.json(
      { error: 'Erro ao validar token' },
```

---

### 4. hardcoded_secret

**Arquivo:** `next.config.js`  
**Linha:** 26  
**CWE:** CWE-798

**Descri칞칚o:** Secret/senha hardcoded no c칩digo

**Recomenda칞칚o:** Mova para vari치veis de ambiente

**C칩digo:**
```
        headers: [
          { key: 'Cache-Control', value: 'no-store, must-revalidate' }
        ]
      },
```

---

### 5. hardcoded_secret

**Arquivo:** `next.config.js`  
**Linha:** 32  
**CWE:** CWE-798

**Descri칞칚o:** Secret/senha hardcoded no c칩digo

**Recomenda칞칚o:** Mova para vari치veis de ambiente

**C칩digo:**
```
        headers: [
          { key: 'Cache-Control', value: 'public, max-age=31536000, immutable' }
        ]
      }
```

---

### 6. unencrypted_pii

**Arquivo:** `prisma/schema.prisma`  
**Linha:** 97  
**CWE:** CWE-311

**Descri칞칚o:** Campo 'cpf' sem criptografia (viola칞칚o LGPD)

**Recomenda칞칚o:** Implemente criptografia AES-256 ou use @db.Text com hash

**C칩digo:**
```
cpf         String?   @unique
```

---

### 7. unencrypted_pii

**Arquivo:** `prisma/schema.prisma`  
**Linha:** 119  
**CWE:** CWE-311

**Descri칞칚o:** Campo 'cpf' sem criptografia (viola칞칚o LGPD)

**Recomenda칞칚o:** Implemente criptografia AES-256 ou use @db.Text com hash

**C칩digo:**
```
cpf            String?    @unique
```

---

### 8. unencrypted_pii

**Arquivo:** `prisma/schema.prisma`  
**Linha:** 345  
**CWE:** CWE-311

**Descri칞칚o:** Campo 'senha' sem criptografia (viola칞칚o LGPD)

**Recomenda칞칚o:** Implemente criptografia AES-256 ou use @db.Text com hash

**C칩digo:**
```
senha            String
```

---

### 9. hardcoded_secret

**Arquivo:** `next.config.js`  
**Linha:** 26  
**CWE:** CWE-798

**Descri칞칚o:** Secret/senha hardcoded no c칩digo

**Recomenda칞칚o:** Mova para vari치veis de ambiente

**C칩digo:**
```
        headers: [
          { key: 'Cache-Control', value: 'no-store, must-revalidate' }
        ]
      },
```

---

### 10. hardcoded_secret

**Arquivo:** `next.config.js`  
**Linha:** 32  
**CWE:** CWE-798

**Descri칞칚o:** Secret/senha hardcoded no c칩digo

**Recomenda칞칚o:** Mova para vari치veis de ambiente

**C칩digo:**
```
        headers: [
          { key: 'Cache-Control', value: 'public, max-age=31536000, immutable' }
        ]
      }
```

---

### 11. env_committed

**Arquivo:** `.env`  
**Linha:** 1  
**CWE:** CWE-540

**Descri칞칚o:** Arquivo .env n칚o deve ser commitado (cont칠m secrets)

**Recomenda칞칚o:** Adicione .env ao .gitignore e rotacione todos os secrets

**C칩digo:**
```
Arquivo .env encontrado no projeto
```

---


## 游 Vulnerabilidades HIGH

### 1. prisma_per_request

**Arquivo:** `criar_super_admin.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient()

async function main() {
```

---

### 2. prisma_per_request

**Arquivo:** `scripts/migrate-to-roles.ts`  
**Linha:** 14  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

async function main() {
```

---

### 3. prisma_per_request

**Arquivo:** `prisma/seed.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient()

async function main() {
```

---

### 4. prisma_per_request

**Arquivo:** `src/app/imoveis/route.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

export async function GET(
```

---

### 5. no_rate_limit

**Arquivo:** `src/app/api/alugueis/route.ts`  
**Linha:** 38  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// POST - Criar novo aluguel
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 6. no_csrf

**Arquivo:** `src/app/api/alugueis/route.ts`  
**Linha:** 38  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```
// POST - Criar novo aluguel
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 7. no_rate_limit

**Arquivo:** `src/app/api/comissoes/route.ts`  
**Linha:** 53  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// POST - Criar comiss칚o manual (b칪nus, capta칞칚o, etc)
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 8. no_rate_limit

**Arquivo:** `src/app/api/comissoes/route.ts`  
**Linha:** 88  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// PATCH - Atualizar status da comiss칚o
export async function PATCH(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 9. no_csrf

**Arquivo:** `src/app/api/comissoes/route.ts`  
**Linha:** 53  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```
// POST - Criar comiss칚o manual (b칪nus, capta칞칚o, etc)
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 10. no_rate_limit

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 8  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const { query } = await req.json()
```

---

### 11. no_input_validation

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 10  
**CWE:** CWE-20

**Descri칞칚o:** Dados de entrada sem valida칞칚o

**Recomenda칞칚o:** Use Zod, Yup ou Joi para validar inputs

**C칩digo:**
```
  try {
    const { query } = await req.json()
    const resultados = await buscaService.buscaInteligente(query)
    return successResponse(resultados)
```

---

### 12. no_csrf

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 8  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const { query } = await req.json()
```

---

### 13. no_rate_limit

**Arquivo:** `src/app/api/corretores/route.ts`  
**Linha:** 38  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// POST - Criar novo corretor
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 14. no_csrf

**Arquivo:** `src/app/api/corretores/route.ts`  
**Linha:** 38  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```
// POST - Criar novo corretor
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 15. no_rate_limit

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 29  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
 */
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 16. no_csrf

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 29  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```
 */
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 17. prisma_per_request

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

// GET - Listar todos os leads
```

---

### 18. no_rate_limit

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 32  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// POST - Criar novo lead
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 19. no_csrf

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 32  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```
// POST - Criar novo lead
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 20. prisma_per_request

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

export async function POST(request: Request) {
```

---

### 21. no_rate_limit

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 6  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const text = await request.text();
```

---

### 22. no_csrf

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 6  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const text = await request.text();
```

---

### 23. prisma_per_request

**Arquivo:** `src/app/api/usuarios/route.ts`  
**Linha:** 5  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

// GET - Listar todos os usu치rios
```

---

### 24. no_rate_limit

**Arquivo:** `src/app/api/usuarios/route.ts`  
**Linha:** 41  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// POST - Criar novo usu치rio
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 25. no_csrf

**Arquivo:** `src/app/api/usuarios/route.ts`  
**Linha:** 41  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```
// POST - Criar novo usu치rio
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 26. no_rate_limit

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 21  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json()
```

---

### 27. no_input_validation

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 23  
**CWE:** CWE-20

**Descri칞칚o:** Dados de entrada sem valida칞칚o

**Recomenda칞칚o:** Use Zod, Yup ou Joi para validar inputs

**C칩digo:**
```
  try {
    const body = await req.json()
    const analise = await prisma.analiseMercado.create({ data: body })
    return successResponse(analise, 'An치lise criada', 201)
```

---

### 28. no_csrf

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 21  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json()
```

---

### 29. no_rate_limit

**Arquivo:** `src/app/api/vendas/route.ts`  
**Linha:** 34  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// POST - Criar nova venda
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 30. no_csrf

**Arquivo:** `src/app/api/vendas/route.ts`  
**Linha:** 34  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```
// POST - Criar nova venda
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 31. prisma_per_request

**Arquivo:** `src/app/api/imoveis/route.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient()

export async function GET(request: NextRequest) {
```

---

### 32. no_rate_limit

**Arquivo:** `src/app/api/imoveis/route.ts`  
**Linha:** 93  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
```

---

### 33. no_csrf

**Arquivo:** `src/app/api/imoveis/route.ts`  
**Linha:** 93  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
```

---

### 34. prisma_per_request

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 9  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```
// Inst칙ncia local do Prisma para garantir que o build n칚o quebre por imports externos
const prisma = new PrismaClient();

export async function POST(req: NextRequest) {
```

---

### 35. no_rate_limit

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 11  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json();
```

---

### 36. no_input_validation

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 13  
**CWE:** CWE-20

**Descri칞칚o:** Dados de entrada sem valida칞칚o

**Recomenda칞칚o:** Use Zod, Yup ou Joi para validar inputs

**C칩digo:**
```
  try {
    const body = await req.json();
    const { email, password } = body;

```

---

### 37. no_csrf

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 11  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json();
```

---

### 38. no_rate_limit

**Arquivo:** `src/app/api/leads/[id]/route.ts`  
**Linha:** 35  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// PUT - Atualizar lead
export async function PUT(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 39. no_rate_limit

**Arquivo:** `src/app/api/leads/[id]/route.ts`  
**Linha:** 64  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// DELETE - Deletar lead
export async function DELETE(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 40. no_rate_limit

**Arquivo:** `src/app/api/leads/[id]/historico/route.ts`  
**Linha:** 5  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// POST: Adiciona um novo ponto na timeline do lead
export async function POST(request: Request, { params }: { params: { id: string } }) {
  try {
    const { detalhes, tipo } = await request.json();
```

---

### 41. no_csrf

**Arquivo:** `src/app/api/leads/[id]/historico/route.ts`  
**Linha:** 5  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```
// POST: Adiciona um novo ponto na timeline do lead
export async function POST(request: Request, { params }: { params: { id: string } }) {
  try {
    const { detalhes, tipo } = await request.json();
```

---

### 42. prisma_per_request

**Arquivo:** `src/app/api/consultas/funil/route.ts`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

// Esta rota agora apenas serve os dados para o seu c칩digo gigante acima
```

---

### 43. no_rate_limit

**Arquivo:** `src/app/api/consultas/[id]/route.ts`  
**Linha:** 6  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// Atualizar status da consulta
export async function PATCH(
  req: NextRequest,
  { params }: { params: { id: string } }
```

---

### 44. no_input_validation

**Arquivo:** `src/app/api/consultas/[id]/route.ts`  
**Linha:** 11  
**CWE:** CWE-20

**Descri칞칚o:** Dados de entrada sem valida칞칚o

**Recomenda칞칚o:** Use Zod, Yup ou Joi para validar inputs

**C칩digo:**
```
  try {
    const body = await req.json()
    const { id } = params

```

---

### 45. prisma_per_request

**Arquivo:** `src/app/api/usuarios/[id]/route.ts`  
**Linha:** 5  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

// GET - Buscar um usu치rio
```

---

### 46. no_rate_limit

**Arquivo:** `src/app/api/usuarios/[id]/route.ts`  
**Linha:** 50  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// PUT - Editar usu치rio
export async function PUT(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 47. no_rate_limit

**Arquivo:** `src/app/api/usuarios/[id]/route.ts`  
**Linha:** 122  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```
// DELETE - Desativar usu치rio (soft delete)
export async function DELETE(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 48. no_rate_limit

**Arquivo:** `src/app/api/imoveis/cadastro/route.ts`  
**Linha:** 4  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 49. no_csrf

**Arquivo:** `src/app/api/imoveis/cadastro/route.ts`  
**Linha:** 4  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 50. prisma_per_request

**Arquivo:** `src/app/api/imoveis/[id]/route.ts`  
**Linha:** 6  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

export async function PATCH(
```

---

### 51. no_rate_limit

**Arquivo:** `src/app/api/imoveis/[id]/route.ts`  
**Linha:** 8  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function PATCH(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 52. no_rate_limit

**Arquivo:** `src/app/api/auth/change-password/route.ts`  
**Linha:** 8  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const user = await getAuthUser(req);
```

---

### 53. no_input_validation

**Arquivo:** `src/app/api/auth/change-password/route.ts`  
**Linha:** 16  
**CWE:** CWE-20

**Descri칞칚o:** Dados de entrada sem valida칞칚o

**Recomenda칞칚o:** Use Zod, Yup ou Joi para validar inputs

**C칩digo:**
```
    
    const { senhaAtual, novaSenha } = await req.json();
    
    if (!senhaAtual || !novaSenha) {
```

---

### 54. no_csrf

**Arquivo:** `src/app/api/auth/change-password/route.ts`  
**Linha:** 8  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const user = await getAuthUser(req);
```

---

### 55. prisma_per_request

**Arquivo:** `src/app/api/auth/redefinir-senha/route.ts`  
**Linha:** 6  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

export async function POST(request: NextRequest) {
```

---

### 56. no_rate_limit

**Arquivo:** `src/app/api/auth/redefinir-senha/route.ts`  
**Linha:** 8  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(request: NextRequest) {
  try {
    const { token, novaSenha } = await request.json();
```

---

### 57. prisma_per_request

**Arquivo:** `src/app/api/auth/login/route.ts`  
**Linha:** 6  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();
const JWT_SECRET = new TextEncoder().encode(process.env.JWT_SECRET || 'TROQUE');

```

---

### 58. no_rate_limit

**Arquivo:** `src/app/api/auth/login/route.ts`  
**Linha:** 9  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 59. no_rate_limit

**Arquivo:** `src/app/api/auth/login/route.ts`  
**Linha:** 143  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function DELETE(request: NextRequest) {
  const response = NextResponse.json({ success: true, message: 'Logout realizado' });
  response.cookies.delete('auth-token');
```

---

### 60. no_csrf

**Arquivo:** `src/app/api/auth/login/route.ts`  
**Linha:** 9  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 61. no_rate_limit

**Arquivo:** `src/app/api/auth/solicitar-reset/route.ts`  
**Linha:** 19  
**CWE:** CWE-770

**Descri칞칚o:** Endpoint sem rate limiting

**Recomenda칞칚o:** Implemente rate limiting com Upstash Redis ou similar

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 62. no_csrf

**Arquivo:** `src/app/api/auth/solicitar-reset/route.ts`  
**Linha:** 19  
**CWE:** CWE-352

**Descri칞칚o:** POST sem prote칞칚o CSRF

**Recomenda칞칚o:** Implemente tokens CSRF

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 63. no_auth_check

**Arquivo:** `GUIA/GerenciadorImoveis.tsx`  
**Linha:** 148  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function GerenciadorImoveis() {
  const [imoveis, setImoveis] = useState<Imovel[]>(initialImoveis);
  const [proprietarios] = useState<Proprietario[]>(initialProprietarios); 
```

---

### 64. no_auth_check

**Arquivo:** `reserva/page.tsx`  
**Linha:** 4  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function Home() {
  return (
    <html lang="pt-BR">
```

---

### 65. dangerouslySetInnerHTML

**Arquivo:** `reserva/page.tsx`  
**Linha:** 13  
**CWE:** CWE-79

**Descri칞칚o:** Uso de dangerouslySetInnerHTML (risco XSS)

**Recomenda칞칚o:** Sanitize HTML com DOMPurify antes de usar

**C칩digo:**
```
      <body style={{ margin: 0, padding: 0 }}>
        <style dangerouslySetInnerHTML={{ __html: `
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; }
```

---

### 66. dangerouslySetInnerHTML

**Arquivo:** `reserva/page.tsx`  
**Linha:** 130  
**CWE:** CWE-79

**Descri칞칚o:** Uso de dangerouslySetInnerHTML (risco XSS)

**Recomenda칞칚o:** Sanitize HTML com DOMPurify antes de usar

**C칩digo:**
```

        <script dangerouslySetInnerHTML={{ __html: `
          document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.altKey && e.key === 'r') {
```

---

### 67. no_auth_check

**Arquivo:** `src/app/page.tsx`  
**Linha:** 35  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function Home() {
  const router = useRouter();
  const [properties, setProperties] = useState<Imovel[]>([]);
```

---

### 68. dangerouslySetInnerHTML

**Arquivo:** `src/app/page.tsx`  
**Linha:** 144  
**CWE:** CWE-79

**Descri칞칚o:** Uso de dangerouslySetInnerHTML (risco XSS)

**Recomenda칞칚o:** Sanitize HTML com DOMPurify antes de usar

**C칩digo:**
```
    <>
      <style dangerouslySetInnerHTML={{ __html: `
        :root { --bg:#f0f4f8; --card:#ffffff; --accent:#1e40af; --accent-light:#3b82f6; --text:#0f172a; --muted:#64748b; --max-width:1200px; }
        * { box-sizing: border-box; }
```

---

### 69. no_auth_check

**Arquivo:** `src/app/layout.tsx`  
**Linha:** 9  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function RootLayout({
  children,
}: {
```

---

### 70. dangerouslySetInnerHTML

**Arquivo:** `src/lib/structured-data.tsx`  
**Linha:** 139  
**CWE:** CWE-79

**Descri칞칚o:** Uso de dangerouslySetInnerHTML (risco XSS)

**Recomenda칞칚o:** Sanitize HTML com DOMPurify antes de usar

**C칩digo:**
```
      type="application/ld+json"
      dangerouslySetInnerHTML={{ __html: JSON.stringify(data) }}
    />
  );
```

---

### 71. no_auth_check

**Arquivo:** `src/components/page.tsx`  
**Linha:** 5  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function Navbar() {
  const pathname = usePathname()
  
```

---

### 72. no_auth_check

**Arquivo:** `src/app/proprietarios/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function ProprietariosPage() {
  const [props, setProps] = useState<any[]>([])
  const [loading, setLoading] = useState<boolean>(true)
```

---

### 73. no_auth_check

**Arquivo:** `src/app/admin/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function AdminDashboard() {
  const router = useRouter();
  const [stats, setStats] = useState({ imoveis: 0, leads: 0, vendas: 0, alugueis: 0 });
```

---

### 74. no_auth_check

**Arquivo:** `src/app/gerenciador-imoveis/page.tsx`  
**Linha:** 107  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```
// --------------------------------------------------------------------------------
export default function GerenciadorStatusImoveis() {
  const [imoveis, setImoveis] = useState<Imovel[]>([]);
  const [proprietarios, setProprietarios] = useState<Proprietario[]>([]);
```

---

### 75. no_auth_check

**Arquivo:** `src/app/toolbox/page.tsx`  
**Linha:** 19  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function Toolbox() {
  const sections = [
    {
```

---

### 76. no_auth_check

**Arquivo:** `src/app/imoveis-publicos/page.tsx`  
**Linha:** 5  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function ImoveisPublicos() {
  const [imoveis, setImoveis] = useState<any[]>([])
  const [filtro, setFiltro] = useState<any>({ tipo: 'todos', maxPreco: 9999999 })
```

---

### 77. no_auth_check

**Arquivo:** `src/app/proprietarios/novo/page.tsx`  
**Linha:** 14  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovoProprietario() {
  // Estados de controle da UI
  const [loading, setLoading] = useState<boolean>(false)
```

---

### 78. no_auth_check

**Arquivo:** `src/app/admin/alugueis/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function AlugueisPage() {
  const [alugueis, setAlugueis] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
```

---

### 79. no_auth_check

**Arquivo:** `src/app/admin/comissoes/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function ComissoesPage() {
  const [data, setData] = useState<any>({ comissoes: [], totais: { pendente: 0, aprovada: 0, paga: 0 } });
  const [loading, setLoading] = useState(true);
```

---

### 80. no_auth_check

**Arquivo:** `src/app/admin/dashboard/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function AdminDashboard() {
  const router = useRouter();
  
```

---

### 81. no_auth_check

**Arquivo:** `src/app/admin/corretores/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function CorretoresPage() {
  const [corretores, setCorretores] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
```

---

### 82. no_auth_check

**Arquivo:** `src/app/admin/proprietarios/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function ProprietariosPage() {
  const [props, setProps] = useState<any[]>([])
  const [loading, setLoading] = useState<boolean>(true)
```

---

### 83. no_auth_check

**Arquivo:** `src/app/admin/redefinir-senha/page.tsx`  
**Linha:** 167  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function RedefinirSenhaPage() {
  return (
    <Suspense fallback={
```

---

### 84. no_auth_check

**Arquivo:** `src/app/admin/leads/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function LeadsPage() {
  const [leads, setLeads] = useState<any[]>([]);
  const [loading, setLoading] = useState<boolean>(true);
```

---

### 85. no_auth_check

**Arquivo:** `src/app/admin/performance/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function PerformancePage() {
  const [data, setData] = useState<any>(null);

```

---

### 86. no_auth_check

**Arquivo:** `src/app/admin/login/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function LoginPage() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 87. no_auth_check

**Arquivo:** `src/app/admin/trocar-senha/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function TrocarSenhaPage() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 88. no_auth_check

**Arquivo:** `src/app/admin/esqueci-senha/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function EsqueciSenhaPage() {
  const [email, setEmail] = useState('');
  const [loading, setLoading] = useState(false);
```

---

### 89. no_auth_check

**Arquivo:** `src/app/admin/acesso-negado/page.tsx`  
**Linha:** 4  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function AcessoNegadoPage({ searchParams }: { searchParams: { from?: string } }) {
  const tentouAcessar = searchParams?.from || 'recurso desconhecido';
  
```

---

### 90. no_auth_check

**Arquivo:** `src/app/admin/consultas/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function ListaConsultas() {
  const [consultas, setConsultas] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
```

---

### 91. no_auth_check

**Arquivo:** `src/app/admin/usuarios/page.tsx`  
**Linha:** 80  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function UsuariosPage() {
  const [usuarios, setUsuarios] = useState<Usuario[]>([]);
  const [corretores, setCorretores] = useState<Corretor[]>([]);
```

---

### 92. no_auth_check

**Arquivo:** `src/app/admin/analise-mercado/page.tsx`  
**Linha:** 35  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function AnaliseMercadoPage() {
  const [analisesSalvas, setAnalisesSalvas] = useState<Analise[]>([])
  const [analisesGeradas, setAnalisesGeradas] = useState<AnaliseDinamica[]>([])
```

---

### 93. no_auth_check

**Arquivo:** `src/app/admin/vendas/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function VendasPage() {
  const [vendas, setVendas] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);
```

---

### 94. no_auth_check

**Arquivo:** `src/app/admin/imoveis/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function ImoveisPage() {
  const [imoveis, setImoveis] = useState<any[]>([]);
  const [loading, setLoading] = useState<boolean>(true);
```

---

### 95. no_auth_check

**Arquivo:** `src/app/admin/alugueis/novo/page.tsx`  
**Linha:** 39  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovoContratoAluguelPage() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 96. no_auth_check

**Arquivo:** `src/app/admin/corretores/novo/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovoCorretorPage() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 97. no_auth_check

**Arquivo:** `src/app/admin/proprietarios/novo/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovoProprietarioPage() {
  const router = useRouter()
  const [loading, setLoading] = useState(false)
```

---

### 98. no_auth_check

**Arquivo:** `src/app/admin/leads/novo/page.tsx`  
**Linha:** 8  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovoLead() {
  const router = useRouter()
  const [form, setForm] = useState({ 
```

---

### 99. no_auth_check

**Arquivo:** `src/app/admin/leads/relatorio/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function RelatorioLeads() {
  const [leads, setLeads] = useState<any[]>([])
  const [loading, setLoading] = useState(true)
```

---

### 100. no_auth_check

**Arquivo:** `src/app/admin/consultas/nova/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovaConsultaPage() {
  const router = useRouter()
  const [loading, setLoading] = useState(false)
```

---

### 101. no_auth_check

**Arquivo:** `src/app/admin/consultas/historico/page.tsx`  
**Linha:** 5  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function HistoricoConsultas() {
  const [consultas, setConsultas] = useState<any[]>([])
  const [filtro, setFiltro] = useState<string>('todas')
```

---

### 102. no_auth_check

**Arquivo:** `src/app/admin/consultas/funil/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function FunilVendas() {
  const [consultas, setConsultas] = useState<any[]>([])
  const [loading, setLoading] = useState<boolean>(true)
```

---

### 103. no_auth_check

**Arquivo:** `src/app/admin/analise-mercado/nova/page.tsx`  
**Linha:** 6  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovaAnalise() {
  const [loading, setLoading] = useState(false)
  const [resultado, setResultado] = useState(null)
```

---

### 104. no_auth_check

**Arquivo:** `src/app/admin/analise-mercado/relatorios/page.tsx`  
**Linha:** 18  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function RelatoriosAnalise() {
  const [analises, setAnalises] = useState<AnaliseMercado[]>([])
  const [cidades, setCidades] = useState<string[]>([])
```

---

### 105. no_auth_check

**Arquivo:** `src/app/admin/vendas/nova/page.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovaVendaPage() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 106. no_auth_check

**Arquivo:** `src/app/admin/imoveis/novo/page.tsx`  
**Linha:** 23  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovoImovel() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 107. no_auth_check

**Arquivo:** `src/app/admin/imoveis/disponiveis/page.tsx`  
**Linha:** 13  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function ImoveisDisponiveis() {
  const [imoveis, setImoveis] = useState<Imovel[]>([])
  const [loading, setLoading] = useState<boolean>(true)
```

---

### 108. no_auth_check

**Arquivo:** `src/app/api/alugueis/novo/page.tsx`  
**Linha:** 39  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function NovoContratoAluguelPage() {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
```

---

### 109. no_auth_check

**Arquivo:** `src/app/imoveis/[id]/page.tsx`  
**Linha:** 21  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function ImovelDetalhes({ params }: { params: { id: string } }) {
  const router = useRouter();
  const [imovel, setImovel] = useState<Imovel | null>(null);
```

---

### 110. dangerouslySetInnerHTML

**Arquivo:** `src/app/imoveis/[id]/page.tsx`  
**Linha:** 67  
**CWE:** CWE-79

**Descri칞칚o:** Uso de dangerouslySetInnerHTML (risco XSS)

**Recomenda칞칚o:** Sanitize HTML com DOMPurify antes de usar

**C칩digo:**
```
    <>
      <style dangerouslySetInnerHTML={{ __html: `
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', sans-serif; background: #f0f4f8; color: #0f172a; }
```

---

### 111. no_auth_check

**Arquivo:** `src/components/graficos/GraficoMercados.tsx`  
**Linha:** 4  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function GraficoMercado({ dados }: { dados: any[] }) {
  return (
    <div className="bg-white p-6 rounded-lg">
```

---

### 112. no_auth_check

**Arquivo:** `src/components/busca/BuscaInteligente.tsx`  
**Linha:** 4  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function BuscaInteligente() {
  const [query, setQuery] = useState<string>('')
  const [resultados, setResultados] = useState<any[]>([])
```

---

### 113. no_auth_check

**Arquivo:** `src/components/ui/Badge.tsx`  
**Linha:** 7  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function Badge({ children, variant = 'neutral', className = '' }: BadgeProps) {
  const variants = {
    success: 'badge-success',
```

---

### 114. no_auth_check

**Arquivo:** `src/components/ui/Container.tsx`  
**Linha:** 10  
**CWE:** CWE-306

**Descri칞칚o:** Componente/p치gina sem verifica칞칚o de autentica칞칚o

**Recomenda칞칚o:** Adicione verifica칞칚o de sess칚o ou proteja com middleware

**C칩digo:**
```

export default function Container({ children, title, subtitle, action }: ContainerProps) {
  return (
    <div className="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
```

---

### 115. prisma_per_request

**Arquivo:** `create-admin.js`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

async function main() {
```

---

### 116. prisma_per_request

**Arquivo:** `test-db.js`  
**Linha:** 3  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

async function testarBanco() {
```

---

### 117. prisma_per_request

**Arquivo:** `testar-senha.js`  
**Linha:** 4  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

async function testar() {
```

---

### 118. prisma_per_request

**Arquivo:** `test-db-completo.js`  
**Linha:** 3  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

async function testarBancoCompleto() {
```

---

### 119. prisma_per_request

**Arquivo:** `desbloquear.js`  
**Linha:** 2  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```
const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

async function desbloquear() {
```

---

### 120. prisma_per_request

**Arquivo:** `api-test-db.js`  
**Linha:** 3  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

export default async function handler(req, res) {
```

---

### 121. prisma_per_request

**Arquivo:** `reset-admin.js`  
**Linha:** 5  
**CWE:** CWE-404

**Descri칞칚o:** Nova inst칙ncia do Prisma por requisi칞칚o (esgota conex칫es)

**Recomenda칞칚o:** Use singleton pattern para PrismaClient

**C칩digo:**
```

const prisma = new PrismaClient();

async function criarSuperAdmin() {
```

---

### 122. exposed_env_var

**Arquivo:** `.env`  
**Linha:** 2  
**CWE:** CWE-798

**Descri칞칚o:** Poss칤vel credencial real em arquivo .env

**Recomenda칞칚o:** Verifique se este arquivo n칚o foi commitado e rotacione credenciais

**C칩digo:**
```
DATABASE_URL="postgresql://neondb_owner:npg_t3XlG7...
```

---

### 123. exposed_env_var

**Arquivo:** `.env`  
**Linha:** 5  
**CWE:** CWE-798

**Descri칞칚o:** Poss칤vel credencial real em arquivo .env

**Recomenda칞칚o:** Verifique se este arquivo n칚o foi commitado e rotacione credenciais

**C칩digo:**
```
JWT_SECRET=7H93jmDy9QK8lJW4s4GS1TkMWaLwI7mP09f9MR7...
```

---

### 124. exposed_env_var

**Arquivo:** `.env`  
**Linha:** 11  
**CWE:** CWE-798

**Descri칞칚o:** Poss칤vel credencial real em arquivo .env

**Recomenda칞칚o:** Verifique se este arquivo n칚o foi commitado e rotacione credenciais

**C칩digo:**
```
RESEND_API_KEY=re_YWTWu58E_LiLEALrxyh2WXraDwVS6RgU...
```

---


## 游리 Vulnerabilidades MEDIUM

### 1. no_cors

**Arquivo:** `src/middleware.ts`  
**Linha:** 155  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// MIDDLEWARE PRINCIPAL
export async function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl;
  
```

---

### 2. no_cors

**Arquivo:** `src/lib/auth.ts`  
**Linha:** 17  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function generateToken(payload: JWTPayload): Promise<string> {
  return await new SignJWT(payload as any)
    .setProtectedHeader({ alg: 'HS256' })
```

---

### 3. no_cors

**Arquivo:** `src/lib/auth.ts`  
**Linha:** 53  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function getAuthUser(request: NextRequest): Promise<JWTPayload | null> {
  try {
    const token = request.cookies.get('auth-token')?.value;
```

---

### 4. no_cors

**Arquivo:** `src/app/robots.txt/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET() {
  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || 'https://seudominio.com.br';
  
```

---

### 5. no_cors

**Arquivo:** `src/app/imoveis/route.ts`  
**Linha:** 6  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET(
  request: Request,
  { params }: { params: { id: string } }
```

---

### 6. no_cors

**Arquivo:** `src/app/sitemap.xml/route.ts`  
**Linha:** 11  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET() {
  try {
    /**
```

---

### 7. no_cors

**Arquivo:** `src/app/admin/analise-mercado/route/route.ts`  
**Linha:** 11  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET() {
  try {
    const analises = await prisma.analiseMercado.findMany({
```

---

### 8. dynamic_force_open

**Arquivo:** `src/app/admin/analise-mercado/route/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 9. no_cors

**Arquivo:** `src/app/api/alugueis/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// GET - Listar todos os alugu칠is
export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url);
```

---

### 10. no_cors

**Arquivo:** `src/app/api/alugueis/route.ts`  
**Linha:** 38  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// POST - Criar novo aluguel
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 11. dynamic_force_open

**Arquivo:** `src/app/api/alugueis/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 12. no_cors

**Arquivo:** `src/app/api/comissoes/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// GET - Listar todas as comiss칫es
export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url);
```

---

### 13. no_cors

**Arquivo:** `src/app/api/comissoes/route.ts`  
**Linha:** 53  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// POST - Criar comiss칚o manual (b칪nus, capta칞칚o, etc)
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 14. no_cors

**Arquivo:** `src/app/api/comissoes/route.ts`  
**Linha:** 88  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// PATCH - Atualizar status da comiss칚o
export async function PATCH(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 15. dynamic_force_open

**Arquivo:** `src/app/api/comissoes/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 16. no_cors

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const { query } = await req.json()
```

---

### 17. dynamic_force_open

**Arquivo:** `src/app/api/busca/route.ts`  
**Linha:** 2  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
import { NextRequest, NextResponse } from 'next/server'
```

---

### 18. no_cors

**Arquivo:** `src/app/api/corretores/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// GET - Listar todos os corretores
export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url);
```

---

### 19. no_cors

**Arquivo:** `src/app/api/corretores/route.ts`  
**Linha:** 38  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// POST - Criar novo corretor
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 20. dynamic_force_open

**Arquivo:** `src/app/api/corretores/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 21. no_cors

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 29  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
 */
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 22. no_cors

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 148  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
 */
export async function GET(request: NextRequest) {
  try {
    const proprietarios = await prisma.proprietario.findMany({
```

---

### 23. dynamic_force_open

**Arquivo:** `src/app/api/proprietarios/route.ts`  
**Linha:** 5  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 24. no_cors

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 7  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// GET - Listar todos os leads
export async function GET(request: NextRequest) {
  try {
    const leads = await prisma.lead.findMany({
```

---

### 25. no_cors

**Arquivo:** `src/app/api/leads/route.ts`  
**Linha:** 32  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// POST - Criar novo lead
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 26. no_cors

**Arquivo:** `src/app/api/analises/route.ts`  
**Linha:** 7  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET(req: NextRequest) {
  try {
    const cidade = req.nextUrl.searchParams.get('cidade') || 'S칚o Paulo'
```

---

### 27. dynamic_force_open

**Arquivo:** `src/app/api/analises/route.ts`  
**Linha:** 2  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
import { NextRequest, NextResponse } from 'next/server'
```

---

### 28. no_cors

**Arquivo:** `src/app/api/teste-conexao/route.ts`  
**Linha:** 4  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET() {
  try {
    // 1. Tenta fazer uma consulta ultra simples (contar registros)
```

---

### 29. no_cors

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 6  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const text = await request.text();
```

---

### 30. no_cors

**Arquivo:** `src/app/api/consultas/route.ts`  
**Linha:** 44  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET() {
  try {
    const consultas = await prisma.consulta.findMany({
```

---

### 31. no_cors

**Arquivo:** `src/app/api/usuarios/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// GET - Listar todos os usu치rios
export async function GET(request: NextRequest) {
  try {
    const usuarios = await prisma.usuario.findMany({
```

---

### 32. no_cors

**Arquivo:** `src/app/api/usuarios/route.ts`  
**Linha:** 41  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// POST - Criar novo usu치rio
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 33. no_cors

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET(req: NextRequest) {
  try {
    const cidade = req.nextUrl.searchParams.get('cidade')
```

---

### 34. dynamic_force_open

**Arquivo:** `src/app/api/analise-mercado/route.ts`  
**Linha:** 2  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';
import { NextRequest, NextResponse } from 'next/server'
```

---

### 35. no_cors

**Arquivo:** `src/app/api/vendas/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// GET - Listar todas as vendas
export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url);
```

---

### 36. no_cors

**Arquivo:** `src/app/api/vendas/route.ts`  
**Linha:** 34  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// POST - Criar nova venda
export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 37. dynamic_force_open

**Arquivo:** `src/app/api/vendas/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 38. no_cors

**Arquivo:** `src/app/api/imoveis/route.ts`  
**Linha:** 6  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET(request: NextRequest) {
  try {
    const searchParams = request.nextUrl.searchParams
```

---

### 39. no_cors

**Arquivo:** `src/app/api/imoveis/route.ts`  
**Linha:** 93  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
```

---

### 40. no_cors

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 11  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const body = await req.json();
```

---

### 41. dynamic_force_open

**Arquivo:** `src/app/api/auth/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 42. no_cors

**Arquivo:** `src/app/api/relatorios/route.ts`  
**Linha:** 4  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET() {
  try {
    // 1. Busca volum칠trica total
```

---

### 43. no_cors

**Arquivo:** `src/app/api/leads/[id]/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// GET - Buscar lead por ID
export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 44. no_cors

**Arquivo:** `src/app/api/leads/[id]/route.ts`  
**Linha:** 35  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// PUT - Atualizar lead
export async function PUT(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 45. no_cors

**Arquivo:** `src/app/api/leads/[id]/route.ts`  
**Linha:** 64  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// DELETE - Deletar lead
export async function DELETE(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 46. dynamic_force_open

**Arquivo:** `src/app/api/leads/[id]/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```
export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 47. no_cors

**Arquivo:** `src/app/api/leads/[id]/historico/route.ts`  
**Linha:** 5  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// POST: Adiciona um novo ponto na timeline do lead
export async function POST(request: Request, { params }: { params: { id: string } }) {
  try {
    const { detalhes, tipo } = await request.json();
```

---

### 48. no_cors

**Arquivo:** `src/app/api/consultas/funil/route.ts`  
**Linha:** 7  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// Esta rota agora apenas serve os dados para o seu c칩digo gigante acima
export async function GET() {
  try {
    const consultas = await prisma.consulta.findMany({
```

---

### 49. no_cors

**Arquivo:** `src/app/api/consultas/[id]/route.ts`  
**Linha:** 6  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// Atualizar status da consulta
export async function PATCH(
  req: NextRequest,
  { params }: { params: { id: string } }
```

---

### 50. no_cors

**Arquivo:** `src/app/api/consultas/[id]/route.ts`  
**Linha:** 37  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// Buscar detalhes da consulta
export async function GET(
  req: NextRequest,
  { params }: { params: { id: string } }
```

---

### 51. no_cors

**Arquivo:** `src/app/api/usuarios/[id]/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// GET - Buscar um usu치rio
export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 52. no_cors

**Arquivo:** `src/app/api/usuarios/[id]/route.ts`  
**Linha:** 50  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// PUT - Editar usu치rio
export async function PUT(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 53. no_cors

**Arquivo:** `src/app/api/usuarios/[id]/route.ts`  
**Linha:** 122  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// DELETE - Desativar usu치rio (soft delete)
export async function DELETE(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 54. no_cors

**Arquivo:** `src/app/api/imoveis/cadastro/route.ts`  
**Linha:** 4  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 55. no_cors

**Arquivo:** `src/app/api/imoveis/publico/route.ts`  
**Linha:** 10  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url)
```

---

### 56. dynamic_force_open

**Arquivo:** `src/app/api/imoveis/publico/route.ts`  
**Linha:** 4  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```

export const dynamic = 'force-dynamic';
export const runtime = 'nodejs';

```

---

### 57. no_cors

**Arquivo:** `src/app/api/imoveis/[id]/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function PATCH(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 58. no_cors

**Arquivo:** `src/app/api/imoveis/[id]/route.ts`  
**Linha:** 90  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
```

---

### 59. no_cors

**Arquivo:** `src/app/api/auth/change-password/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(req: NextRequest) {
  try {
    const user = await getAuthUser(req);
```

---

### 60. dynamic_force_open

**Arquivo:** `src/app/api/auth/change-password/route.ts`  
**Linha:** 1  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```
export const dynamic = 'force-dynamic';

import { NextRequest, NextResponse } from 'next/server';
```

---

### 61. no_cors

**Arquivo:** `src/app/api/auth/redefinir-senha/route.ts`  
**Linha:** 8  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(request: NextRequest) {
  try {
    const { token, novaSenha } = await request.json();
```

---

### 62. no_cors

**Arquivo:** `src/app/api/auth/redefinir-senha/route.ts`  
**Linha:** 92  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```
// Endpoint para validar token (opcional - para verificar antes de mostrar formul치rio)
export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url);
```

---

### 63. no_cors

**Arquivo:** `src/app/api/auth/login/route.ts`  
**Linha:** 9  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
```

---

### 64. no_cors

**Arquivo:** `src/app/api/auth/login/route.ts`  
**Linha:** 143  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function DELETE(request: NextRequest) {
  const response = NextResponse.json({ success: true, message: 'Logout realizado' });
  response.cookies.delete('auth-token');
```

---

### 65. no_cors

**Arquivo:** `src/app/api/auth/solicitar-reset/route.ts`  
**Linha:** 19  
**CWE:** CWE-942

**Descri칞칚o:** API sem configura칞칚o CORS

**Recomenda칞칚o:** Configure CORS adequadamente

**C칩digo:**
```

export async function POST(request: Request) {
  try {
    const body = await request.json();
```

---

### 66. dynamic_force_open

**Arquivo:** `src/app/toolbox/page.tsx`  
**Linha:** 3  
**CWE:** CWE-400

**Descri칞칚o:** Rota for칞ada como din칙mica (pode impactar performance)

**Recomenda칞칚o:** Revise se realmente precisa ser din칙mica

**C칩digo:**
```

export const dynamic = 'force-dynamic';

import React from 'react';
```

---

